define(['jquery','Meta_Conversion/js/metaPixelTracker'],function($,metaPixelTracker){'use strict';let productName,sku,productId,price,payload;return function(config){function callMetaPixelTracker(){if(config!==null){config.browserEventData.payload.content_name=payload.productName;config.browserEventData.payload.content_ids=[payload.sku];config.browserEventData.payload.content_type='product_group';config.payload.content_name=payload.productName;config.payload.content_ids=[payload.sku];config.payload.content_type='product_group';metaPixelTracker(config);}}
function _getPrice(element){productId=$(element).parents('.product-item-details').find('.price-final_price').data('product-id');price=$('#old-price-'+productId+'-widget-product-grid').data('price-amount');if(!price){productId=$(element).parents('.product-info-main').find('.price-final_price').data('product-id');price=$('#product-price-'+productId).data('price-amount');}
return price;}
function _getProductName(element){productName=$(element).parents('.product-item-details').find('.product-item-link').text();productName=productName.trim();if(!productName){productName=$(element).parents('.product-info-main').find('.page-title .base').text();productName=productName.trim();}
return productName;}
function _getSku(element){sku=$(element).parents('li.product-item').find('form').data('product-sku');if(!sku){sku=$(element).parents('.product-info-main').find('.product.attribute.sku .value').text();sku=sku.trim();}
return sku;}
function setPayload(element){payload={'productName':_getProductName(element),'sku':_getSku(element)};config.browserEventData.payload.value=_getPrice(element);config.payload.value=_getPrice(element);}
$('.super-attribute-select').on('change',function(){setPayload(this);callMetaPixelTracker();});$('[class*="swatch-opt"]').on('click','.swatch-option',function(){setPayload(this);callMetaPixelTracker();});};});